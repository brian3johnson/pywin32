
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Generated Python COM Support &#8212; pywin32 305 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="win32com.client.VARIANT" href="variant.html" />
    <link rel="prev" title="Quick Start to Server side COM and Python" href="QuickStartServerCom.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p><img alt="Python and COM, Blowing the rest away" src="../_images/pycom_blowing.gif" /></p>
<section id="generated-python-com-support">
<h1>Generated Python COM Support<a class="headerlink" href="#generated-python-com-support" title="Permalink to this heading">¶</a></h1>
<div class="admonition-existing-document admonition">
<p class="admonition-title">Existing document</p>
<p><code class="file docutils literal notranslate"><span class="pre">\com\win32com\html\GeneratedSupport.html</span></code></p>
</div>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id1">Introduction</a></p></li>
<li><p><a class="reference internal" href="#design-goals" id="id2">Design Goals</a></p></li>
<li><p><a class="reference internal" href="#how-to-generate-support-files" id="id3">How to generate support files</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id4">Usage</a></p></li>
<li><p><a class="reference internal" href="#using-makepy-to-help-with-the-runtime-generation" id="id5">Using makepy to help with the runtime generation</a></p></li>
<li><p><a class="reference internal" href="#win32com-client-gencache-functions" id="id6">win32com.client.gencache functions</a></p></li>
</ul>
</nav>
<p>This file describes how the Python COM extensions support “generated files”. The information contained here is for expert Python users, and people who need to take advantage of the advanced features of the support. More general information is available in the Quick Start to Client Side COM documentation.</p>
<section id="introduction">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>Generated Python COM support means that a .py file exists behind a particular COM object. This .py file is created by a generation process from a COM type library.</p>
<p>This documentation talks about the process of the creation of the .py files.</p>
</section>
<section id="design-goals">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Design Goals</a><a class="headerlink" href="#design-goals" title="Permalink to this heading">¶</a></h2>
<p>The main design goal is that the Python programmer need not know much about the type library they wish to work with. They need not know the name of a specific Python module to use a type library. COM uses an IID, version and LCID to identify a type library. Therefore, the Python programmer only need know this information to obtain a Python module.</p>
</section>
<section id="how-to-generate-support-files">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">How to generate support files</a><a class="headerlink" href="#how-to-generate-support-files" title="Permalink to this heading">¶</a></h2>
<p>Support files can be generated either “off-line” by the makepy utility, or in custom Python code.</p>
<p>Using makepy is in many ways far simpler - you simply pick the type library and you are ready to go! The Quick Start to Client Side COM documentation describes this process.</p>
<p>Often however, you will want to use code to ensure the type library has been processed. This document describes that process.</p>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<p>The win32com.client.gencache module implements all functionality. As described above, if you wish to generate support from code, you need to know the IID, version and LCID of the type library.</p>
<p>The following functions are defined. The best examples of their usage is probably in the Pythonwin OCX Demos, and the COM Test Suite (particularly testMSOffice.py)</p>
<p>Note that the gencache.py file supports being run from the command line, and provides some utilities for managing the cache. Run the file to see usage options.</p>
</section>
<section id="using-makepy-to-help-with-the-runtime-generation">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Using makepy to help with the runtime generation</a><a class="headerlink" href="#using-makepy-to-help-with-the-runtime-generation" title="Permalink to this heading">¶</a></h2>
<p>makepy supports a “-i” option, to print information about a type library. When you select a type library, makepy will print out 2 lines of code that you cant paste into your application. This will then allow your module to generate the makepy .py file at runtime, but will only take you a few seconds!</p>
</section>
<section id="win32com-client-gencache-functions">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">win32com.client.gencache functions</a><a class="headerlink" href="#win32com-client-gencache-functions" title="Permalink to this heading">¶</a></h2>
<p>def MakeModuleForTypelib(typelibCLSID, lcid, major, minor, progressInstance = None):
Generate support for a type library.</p>
<p>Given the IID, LCID and version information for a type library, generate and import the necessary support files.</p>
<p>Returns</p>
<p>The Python module. No exceptions are caught.</p>
<p>Params</p>
<p>typelibCLSID
IID of the type library.</p>
<p>major
Integer major version.</p>
<p>minor
Integer minor version.</p>
<p>lcid
Integer LCID for the library.</p>
<p>progressInstance
A class instance to use as the progress indicator, or None to use the default GUI one.</p>
<p>def EnsureModule(typelibCLSID, lcid, major, minor, progressInstance = None):
Ensure Python support is loaded for a type library, generating if necessary.</p>
<p>Given the IID, LCID and version information for a type library, check and if necessary generate, then import the necessary support files.</p>
<p>Returns:</p>
<p>The Python module. No exceptions are caught during the generate process.</p>
<p>Params</p>
<p>typelibCLSID
IID of the type library.</p>
<p>major
Integer major version.</p>
<p>minor
Integer minor version.</p>
<p>lcid
Integer LCID for the library.</p>
<p>progressInstance
A class instance to use as the progress indicator, or None to use the default GUI one.</p>
<p>def GetClassForProgID(progid):
Get a Python class for a Program ID</p>
<p>Given a Program ID, return a Python class which wraps the COM object</p>
<p>Returns</p>
<p>The Python class, or None if no module is available.</p>
<p>Params</p>
<p>progid
A COM ProgramID or IID (eg, “Word.Application”)</p>
<p>def GetModuleForProgID(progid):
Get a Python module for a Program ID</p>
<p>Given a Program ID, return a Python module which contains the class which wraps the COM object.</p>
<p>Returns</p>
<p>The Python module, or None if no module is available.</p>
<p>Params:</p>
<p>progid
A COM ProgramID or IID (eg, “Word.Application”)</p>
<p>def GetModuleForCLSID(clsid):
Get a Python module for a CLSID</p>
<p>Given a CLSID, return a Python module which contains the class which wraps the COM object.</p>
<p>Returns</p>
<p>The Python module, or None if no module is available.</p>
<p>Params</p>
<p>progid
A COM CLSID (ie, not the description)</p>
<p>def GetModuleForTypelib(typelibCLSID, lcid, major, minor):
Get a Python module for a type library ID</p>
<p>Returns</p>
<p>An imported Python module, else None</p>
<p>Params:</p>
<p>typelibCLSID
IID of the type library.</p>
<p>major
Integer major version.</p>
<p>minor
Integer minor version</p>
<p>lcid
Integer LCID for the library.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">pywin32</a></h1>



<p class="blurb">Python for Windows Extensions</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=mhammond&repo=pywin32&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted.html">Getting Started Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../win32/index.html">Win32 Extensions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">PythonCOM</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="QuickStartClientCom.html">Client-side COM</a></li>
<li class="toctree-l2"><a class="reference internal" href="QuickStartServerCom.html">Server-side COM</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Generated COM</a></li>
<li class="toctree-l2"><a class="reference internal" href="variant.html">VARIANT</a></li>
<li class="toctree-l2"><a class="reference internal" href="package.html">win32com</a></li>
<li class="toctree-l2"><a class="reference internal" href="PythonCOM.html">Python &amp; COM</a></li>
<li class="toctree-l2"><a class="reference internal" href="misc.html">Miscellany</a></li>
<li class="toctree-l2"><a class="reference internal" href="active_directory.html">Active Directory</a></li>
<li class="toctree-l2"><a class="reference internal" href="adsi.html">ADSI &amp; Exchange</a></li>
<li class="toctree-l2"><a class="reference internal" href="asp.html">ASP and Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="cpp.html">Python, C++, and COM</a></li>
<li class="toctree-l2"><a class="reference internal" href="mts.html">MTS and Python for NT</a></li>
<li class="toctree-l2"><a class="reference internal" href="shell.html">win32com.shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="directsound.html">DirectSound examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="samples/index.html">Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="apidoc/index.html">API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../adodbapi/index.html">ADO DB-API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../isapi/index.html">ISAPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Pythonwin/index.html"> Pythonwin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SWIG/index.html">SWIG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources.html">Resources</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Mark Hammond.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/com/GeneratedSupport.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>