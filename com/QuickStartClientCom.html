
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Quick Start to Client side COM and Python &#8212; pywin32 305 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Quick Start to Server side COM and Python" href="QuickStartServerCom.html" />
    <link rel="prev" title="PythonCOM" href="index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p><img alt="Python and COM, Blowing the rest away" src="../_images/pycom_blowing.gif" /></p>
<section id="quick-start-to-client-side-com-and-python">
<h1>Quick Start to Client side COM and Python<a class="headerlink" href="#quick-start-to-client-side-com-and-python" title="Permalink to this heading">¬∂</a></h1>
<div class="admonition-existing-document admonition">
<p class="admonition-title">Existing document</p>
<p><code class="file docutils literal notranslate"><span class="pre">\com\win32com\html\QuickStartClientCom.html</span></code></p>
</div>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id2">Introduction</a></p></li>
<li><p><a class="reference internal" href="#quick-start" id="id3">Quick Start</a></p>
<ul>
<li><p><a class="reference internal" href="#to-use-a-com-object-from-python" id="id4">To use a COM object from Python</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-know-which-methods-and-properties-are-available" id="id5">How do I know which methods and properties are available?</a></p></li>
<li><p><a class="reference internal" href="#the-python-com-browser" id="id6">The Python COM browser</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#static-dispatch-or-type-safe-objects" id="id7">Static Dispatch (or Type Safe) objects</a></p>
<ul>
<li><p><a class="reference internal" href="#how-do-i-get-at-the-generated-module" id="id8">How do I get at the generated module?</a></p></li>
<li><p><a class="reference internal" href="#to-generate-python-sources-supporting-a-com-object" id="id9">To generate Python Sources supporting a COM object</a></p></li>
<li><p><a class="reference internal" href="#using-com-constants" id="id10">Using COM Constants</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this heading">¬∂</a></h2>
<p>This documents how to quickly start using <abbr title="Component Object Model">COM</abbr> from Python. It is not a thorough discussion of the <abbr title="Component Object Model">COM</abbr> system, or of the concepts introduced by <abbr title="Component Object Model">COM</abbr>.</p>
<p>Other good information on <abbr title="Component Object Model">COM</abbr> can be found in various conference tutorials. Please see the collection of <a class="reference external" href="http://starship.python.net/crew/mhammond/conferences">Mark‚Äôs conference tutorials</a> üíÄüîó.</p>
<p>For information on implementing <abbr title="Component Object Model">COM</abbr> objects using Python, please see a <a class="reference internal" href="QuickStartServerCom.html"><span class="doc">Quick Start to Server side COM and Python</span></a>.</p>
</section>
<section id="quick-start">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Quick Start</a><a class="headerlink" href="#quick-start" title="Permalink to this heading">¬∂</a></h2>
<section id="to-use-a-com-object-from-python">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">To use a COM object from Python</a><a class="headerlink" href="#to-use-a-com-object-from-python" title="Permalink to this heading">¬∂</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">win32com.client</span>
<span class="n">o</span> <span class="o">=</span> <span class="n">win32com</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">Dispatch</span><span class="p">(</span><span class="s2">&quot;Object.Name&quot;</span><span class="p">)</span>
<span class="n">o</span><span class="o">.</span><span class="n">Method</span><span class="p">()</span>
<span class="n">o</span><span class="o">.</span><span class="n">property</span> <span class="o">=</span> <span class="s2">&quot;New Value&quot;</span>
<span class="nb">print</span> <span class="n">o</span><span class="o">.</span><span class="n">property</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">o</span> <span class="o">=</span> <span class="n">win32com</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">Dispatch</span><span class="p">(</span><span class="s2">&quot;Excel.Application&quot;</span><span class="p">)</span>
<span class="n">o</span><span class="o">.</span><span class="n">Visible</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">o</span><span class="o">.</span><span class="n">Workbooks</span><span class="o">.</span><span class="n">Add</span><span class="p">()</span> <span class="c1"># for office 97 ‚Äì 95 a bit different!</span>
<span class="n">o</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="s2">&quot;Hello&quot;</span>
</pre></div>
</div>
<p>And we will see the word ‚ÄúHello‚Äù appear in the top cell.</p>
</section>
<section id="how-do-i-know-which-methods-and-properties-are-available">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">How do I know which methods and properties are available?</a><a class="headerlink" href="#how-do-i-know-which-methods-and-properties-are-available" title="Permalink to this heading">¬∂</a></h3>
<p>Good question. This is hard! You need to use the documentation with the products, or possibly a <abbr title="Component Object Model">COM</abbr> browser. Note however that <abbr title="Component Object Model">COM</abbr> browsers typically rely on these objects registering themselves in certain ways, and many objects to not do this. You are just expected to know.</p>
</section>
<section id="the-python-com-browser">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">The Python COM browser</a><a class="headerlink" href="#the-python-com-browser" title="Permalink to this heading">¬∂</a></h3>
<p>PythonCOM comes with a basic <abbr title="Component Object Model">COM</abbr> browser that may show you the information you need. Note that this package requires <a class="reference internal" href="../Pythonwin/index.html"><span class="doc"> Pythonwin</span></a> (i.e., the MFC GUI environment) to be installed for this to work.</p>
<p>There are far better <abbr title="Component Object Model">COM</abbr> browsers available. I tend to use the one that comes with MSVC, or this one!</p>
<p>To run the browser, simply select it from the <strong class="program">Pythonwin</strong> <span class="menuselection">Tools</span> menu, or <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">double</kbd>-<kbd class="kbd docutils literal notranslate">click</kbd></kbd> on the file <code class="file docutils literal notranslate"><span class="pre">win32comclientcombrowse.py</span></code></p>
</section>
</section>
<section id="static-dispatch-or-type-safe-objects">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Static Dispatch (or Type Safe) objects</a><a class="headerlink" href="#static-dispatch-or-type-safe-objects" title="Permalink to this heading">¬∂</a></h2>
<p>In the above examples, if we printed the <code class="code docutils literal notranslate"><span class="pre">repr(o)</span></code> object above, it would have resulted in:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">COMObject</span> <span class="n">Excel</span><span class="o">.</span><span class="n">Application</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This reflects that the object is a generic <abbr title="Component Object Model">COM</abbr> object that Python has no special knowledge of (other than the name you used to create it!). This is known as a <em>dynamic dispatch</em> object, as all knowledge is built dynamically. The <code class="code docutils literal notranslate"><span class="pre">win32com</span></code> package also has the concept of <em>static dispatch</em> objects, which gives Python up-front knowledge about the objects that it is working with (including arguments, argument types, etc.).</p>
<p>In a nutshell, Static Dispatch involves the generation of a <code class="file docutils literal notranslate"><span class="pre">.py</span></code> file that contains support for the specific object. For more overview information, please see the documentation references above.</p>
<p>The generation and management of the <code class="file docutils literal notranslate"><span class="pre">.py</span></code> files is somewhat automatic, and involves one of two steps:</p>
<ul class="simple">
<li><p>Using <code class="file docutils literal notranslate"><span class="pre">makepy.py</span></code> to select a <abbr title="Component Object Model">COM</abbr> library. This process is very similar to <strong class="program">Visual Basic</strong>, where you select from a list of all objects installed on your system, and once selected the objects are magically useable.</p></li>
</ul>
<p>or</p>
<ul class="simple">
<li><p>Use explicit code to check for, and possibly generate, support at run-time. This is very powerful, as it allows the developer to avoid ensuring the user has selected the appropriate type library. This option is extremely powerful for OCX users, as it allows Python code to sub-class an OCX control, but the actual sub-class can be generated at run-time. Use <code class="file docutils literal notranslate"><span class="pre">makepy.py</span></code> with a <code class="docutils literal notranslate"><span class="pre">-i</span></code> option to see how to include this support in your Python code.</p></li>
</ul>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>Add an option directive for and option role to the -i command line option above.</p>
</div>
<p>The <code class="code docutils literal notranslate"><span class="pre">win32com.client.gencache</span></code> module manages these generated files. This module has some <a class="reference internal" href="GeneratedSupport.html"><span class="doc">documentation</span></a> of its own, but you probably don‚Äôt need to know the gory details!</p>
<section id="how-do-i-get-at-the-generated-module">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">How do I get at the generated module?</a><a class="headerlink" href="#how-do-i-get-at-the-generated-module" title="Permalink to this heading">¬∂</a></h3>
<p>You will notice that the generated file name is long and cryptic - obviously not designed for humans to work with! So how do you get at the module object for the generated code?</p>
<p>Hopefully, the answer is <em>you shouldn‚Äôt need to</em>. All generated file support is generally available directly via <code class="code docutils literal notranslate"><span class="pre">win32com.client.Dispatch</span></code> and <code class="code docutils literal notranslate"><span class="pre">win32com.client.constants</span></code>. But should you ever really need the Python module object, the <code class="code docutils literal notranslate"><span class="pre">win32com.client.gencache</span></code> module has functions specifically for this. The functions <code class="code docutils literal notranslate"><span class="pre">GetModuleForCLSID</span></code> and <code class="code docutils literal notranslate"><span class="pre">GetModuleForProgID</span></code> both return Python module objects that you can use in your code. See the docstrings in the gencache code for more details.</p>
</section>
<section id="to-generate-python-sources-supporting-a-com-object">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">To generate Python Sources supporting a COM object</a><a class="headerlink" href="#to-generate-python-sources-supporting-a-com-object" title="Permalink to this heading">¬∂</a></h3>
<section id="example-using-microsoft-office-97">
<h4>Example using Microsoft Office 97<a class="headerlink" href="#example-using-microsoft-office-97" title="Permalink to this heading">¬∂</a></h4>
<p>Either:</p>
<ul class="simple">
<li><p>Run <code class="file docutils literal notranslate"><span class="pre">win32comclientmakepy.py</span></code> (e.g., run it from the command window, or double-click on it) and a list will be presented. Select the Type Library ‚Äò<code class="file docutils literal notranslate"><span class="pre">Microsoft</span> <span class="pre">Word</span> <span class="pre">8.0</span> <span class="pre">Object</span> <span class="pre">Library</span></code>‚Äô</p></li>
<li><p>From a command prompt, run the command <strong class="program">makepy.py &quot;Microsoft Word 8.0 Object Library&quot;</strong> (include the double quotes). This simply avoids the selection process.</p></li>
<li><p>If you desire, you can also use explicit code to generate it just before you need to use it at runtime. Run <strong class="program">makepy.py -i &quot;Microsoft Word 8.0 Object Library&quot;</strong> (include the double quotes) to see how to do this.</p></li>
</ul>
<p>And that is it! Nothing more needed. No special import statements needed! Now, you simply need say:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">win32com.client</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">=</span><span class="n">win32com</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">Dispatch</span><span class="p">(</span><span class="s2">&quot;Word.Application&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">Visible</span><span class="o">=</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span>
<span class="go">&lt;win32com.gen_py.Microsoft Word 8.0 Object Library._Application&gt;</span>
</pre></div>
</div>
<p>Note that now Python knows the explicit type of the object.</p>
</section>
</section>
<section id="using-com-constants">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">Using COM Constants</a><a class="headerlink" href="#using-com-constants" title="Permalink to this heading">¬∂</a></h3>
<p>Makepy automatically installs all generated constants from a type library in an object called <code class="code docutils literal notranslate"><span class="pre">win32com.clients.constants</span></code>. You do not need to do anything special to make these constants work, other than create the object itself (i.e., in the example above, the constants relating to <strong class="program">Word</strong> would automatically be available after the <code class="code docutils literal notranslate"><span class="pre">w=win32com.client.Dispatch(&quot;Word.Application&quot;)</span></code> statement).</p>
<p>For example, immediately after executing the code above, you could execute the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">WindowState</span> <span class="o">=</span> <span class="n">win32com</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">wdWindowStateMinimize</span>
</pre></div>
</div>
<p>and <strong class="program">Word</strong> will Minimize.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">pywin32</a></h1>



<p class="blurb">Python for Windows Extensions</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=mhammond&repo=pywin32&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted.html">Getting Started Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../win32/index.html">Win32 Extensions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">PythonCOM</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Client-side COM</a></li>
<li class="toctree-l2"><a class="reference internal" href="QuickStartServerCom.html">Server-side COM</a></li>
<li class="toctree-l2"><a class="reference internal" href="GeneratedSupport.html">Generated COM</a></li>
<li class="toctree-l2"><a class="reference internal" href="variant.html">VARIANT</a></li>
<li class="toctree-l2"><a class="reference internal" href="package.html">win32com</a></li>
<li class="toctree-l2"><a class="reference internal" href="PythonCOM.html">Python &amp; COM</a></li>
<li class="toctree-l2"><a class="reference internal" href="misc.html">Miscellany</a></li>
<li class="toctree-l2"><a class="reference internal" href="active_directory.html">Active Directory</a></li>
<li class="toctree-l2"><a class="reference internal" href="adsi.html">ADSI &amp; Exchange</a></li>
<li class="toctree-l2"><a class="reference internal" href="asp.html">ASP and Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="cpp.html">Python, C++, and COM</a></li>
<li class="toctree-l2"><a class="reference internal" href="mts.html">MTS and Python for NT</a></li>
<li class="toctree-l2"><a class="reference internal" href="shell.html">win32com.shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="directsound.html">DirectSound examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="samples/index.html">Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="apidoc/index.html">API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../adodbapi/index.html">ADO DB-API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../isapi/index.html">ISAPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Pythonwin/index.html"> Pythonwin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SWIG/index.html">SWIG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources.html">Resources</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Mark Hammond.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/com/QuickStartClientCom.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>